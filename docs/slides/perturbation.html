<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Computational Economics – perturbation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Introduction to Computational Economics</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Introduction to Computational Economics</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Slides</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/introduction.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/convergence.html" class="sidebar-item-text sidebar-link">Convergence of sequences</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/optimization.html" class="sidebar-item-text sidebar-link">Optimization</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Tutorials</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  notebooks/2_solow_correction.ipynb
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#perturbation-analysis" id="toc-perturbation-analysis" class="nav-link active" data-scroll-target="#perturbation-analysis">Perturbation Analysis</a>
  <ul class="collapse">
  <li><a href="#computational-economics-2022-eco309" id="toc-computational-economics-2022-eco309" class="nav-link" data-scroll-target="#computational-economics-2022-eco309">Computational Economics 2022 (ECO309)</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#introduction-plan" id="toc-introduction-plan" class="nav-link" data-scroll-target="#introduction-plan">Introduction: Plan</a></li>
  <li><a href="#first-order-conditions" id="toc-first-order-conditions" class="nav-link" data-scroll-target="#first-order-conditions">First Order Conditions</a></li>
  <li><a href="#two-approaches" id="toc-two-approaches" class="nav-link" data-scroll-target="#two-approaches">Two approaches</a></li>
  <li><a href="#lagrangian" id="toc-lagrangian" class="nav-link" data-scroll-target="#lagrangian">Lagrangian</a></li>
  <li><a href="#constrained-maximization" id="toc-constrained-maximization" class="nav-link" data-scroll-target="#constrained-maximization">Constrained maximization</a></li>
  <li><a href="#constrained-maximization-infinite-horizon" id="toc-constrained-maximization-infinite-horizon" class="nav-link" data-scroll-target="#constrained-maximization-infinite-horizon">Constrained maximization (infinite horizon)</a></li>
  <li><a href="#constrained-maximization-infinite-horizon-1" id="toc-constrained-maximization-infinite-horizon-1" class="nav-link" data-scroll-target="#constrained-maximization-infinite-horizon-1">Constrained maximization (infinite horizon)</a></li>
  <li><a href="#constrained-maximization-1" id="toc-constrained-maximization-1" class="nav-link" data-scroll-target="#constrained-maximization-1">Constrained maximization</a></li>
  </ul></li>
  <li><a href="#deterministic-neoclassical-growth-model" id="toc-deterministic-neoclassical-growth-model" class="nav-link" data-scroll-target="#deterministic-neoclassical-growth-model">Deterministic Neoclassical Growth Model</a>
  <ul class="collapse">
  <li><a href="#lagrangian-1" id="toc-lagrangian-1" class="nav-link" data-scroll-target="#lagrangian-1">Lagrangian</a></li>
  <li><a href="#lagrangian-2" id="toc-lagrangian-2" class="nav-link" data-scroll-target="#lagrangian-2">Lagrangian</a></li>
  <li><a href="#first-order-model" id="toc-first-order-model" class="nav-link" data-scroll-target="#first-order-model">First order model</a></li>
  <li><a href="#steady-state" id="toc-steady-state" class="nav-link" data-scroll-target="#steady-state">Steady-State</a></li>
  </ul></li>
  <li><a href="#perturbation-analysis-1" id="toc-perturbation-analysis-1" class="nav-link" data-scroll-target="#perturbation-analysis-1">Perturbation Analysis</a>
  <ul class="collapse">
  <li><a href="#general-idea" id="toc-general-idea" class="nav-link" data-scroll-target="#general-idea">General idea</a></li>
  <li><a href="#d-example-1" id="toc-d-example-1" class="nav-link" data-scroll-target="#d-example-1">1d Example 1</a></li>
  <li><a href="#d-example-2" id="toc-d-example-2" class="nav-link" data-scroll-target="#d-example-2">1d Example 2</a></li>
  <li><a href="#d-example-3" id="toc-d-example-3" class="nav-link" data-scroll-target="#d-example-3">1d example 3</a></li>
  <li><a href="#perturb-the-neoclassical-model" id="toc-perturb-the-neoclassical-model" class="nav-link" data-scroll-target="#perturb-the-neoclassical-model">Perturb the neoclassical model</a></li>
  <li><a href="#result" id="toc-result" class="nav-link" data-scroll-target="#result">Result:</a></li>
  </ul></li>
  <li><a href="#solution-using-linear-time-iteration" id="toc-solution-using-linear-time-iteration" class="nav-link" data-scroll-target="#solution-using-linear-time-iteration">Solution using Linear Time iteration</a>
  <ul class="collapse">
  <li><a href="#our-problem" id="toc-our-problem" class="nav-link" data-scroll-target="#our-problem">Our problem</a></li>
  <li><a href="#solution" id="toc-solution" class="nav-link" data-scroll-target="#solution">Solution</a></li>
  <li><a href="#optimality-condition" id="toc-optimality-condition" class="nav-link" data-scroll-target="#optimality-condition">Optimality condition:</a></li>
  <li><a href="#linear-time-iteration" id="toc-linear-time-iteration" class="nav-link" data-scroll-target="#linear-time-iteration">Linear Time Iteration</a></li>
  <li><a href="#linear-time-iteration-2" id="toc-linear-time-iteration-2" class="nav-link" data-scroll-target="#linear-time-iteration-2">Linear Time Iteration (2)</a></li>
  <li><a href="#simulating-the-model" id="toc-simulating-the-model" class="nav-link" data-scroll-target="#simulating-the-model">Simulating the model</a></li>
  <li><a href="#spectral-radius" id="toc-spectral-radius" class="nav-link" data-scroll-target="#spectral-radius">Spectral radius</a></li>
  <li><a href="#stability-of-the-backward-operator" id="toc-stability-of-the-backward-operator" class="nav-link" data-scroll-target="#stability-of-the-backward-operator">Stability of the backward operator</a></li>
  <li><a href="#differentials" id="toc-differentials" class="nav-link" data-scroll-target="#differentials">Differentials</a></li>
  <li><a href="#examples-of-linear-operators" id="toc-examples-of-linear-operators" class="nav-link" data-scroll-target="#examples-of-linear-operators">Examples of linear operators</a></li>
  <li><a href="#back-to-the-time-iteration-operator" id="toc-back-to-the-time-iteration-operator" class="nav-link" data-scroll-target="#back-to-the-time-iteration-operator">Back to the time iteration operator</a></li>
  <li><a href="#the-derivative-of-the-time-iteration-operator" id="toc-the-derivative-of-the-time-iteration-operator" class="nav-link" data-scroll-target="#the-derivative-of-the-time-iteration-operator">The derivative of the time-iteration operator</a></li>
  <li><a href="#recap" id="toc-recap" class="nav-link" data-scroll-target="#recap">Recap</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="perturbation-analysis" class="level1">
<h1>Perturbation Analysis</h1>
<section id="computational-economics-2022-eco309" class="level2">
<h2 class="anchored" data-anchor-id="computational-economics-2022-eco309">Computational Economics 2022 (ECO309)</h2>
<hr>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<ul>
<li>Many models with continuous values/states
<ul>
<li>don’t have a closed form solution…</li>
<li>are subject to the curse of dimensionality…</li>
<li>and other approximation challenges…</li>
<li>…unless we can solve them around a steady-state</li>
</ul></li>
<li>Perturbation analysis
<ul>
<li>assume a model has a steady-state</li>
<li>considers small deviations around the steady-state<br>
</li>
<li>relatively easy to implement</li>
<li>scales well (-&gt; DSGE modelling in Central Banks)</li>
</ul></li>
</ul>
<hr>
</section>
<section id="introduction-plan" class="level3">
<h3 class="anchored" data-anchor-id="introduction-plan">Introduction: Plan</h3>
<ul>
<li>To compute the perturbed solution, we need:
<ol type="1">
<li>a suitable representation of the model</li>
</ol>
<ul>
<li>get rid of <span class="math inline">\(\max\)</span> operator</li>
<li>first order conditions</li>
</ul>
<ol start="2" type="1">
<li>the steady-state</li>
<li>the derivatives of the model at the steady-state</li>
</ol>
<ul>
<li>a <em>linear</em> representation</li>
</ul>
<ol start="4" type="1">
<li>to solve the linear system</li>
</ol>
<ul>
<li>linear time iteration</li>
</ul></li>
<li>In practice, 2., 3. and 4. are done automatically</li>
</ul>
<hr>
</section>
<section id="first-order-conditions" class="level3">
<h3 class="anchored" data-anchor-id="first-order-conditions">First Order Conditions</h3>
<hr>
</section>
<section id="two-approaches" class="level3">
<h3 class="anchored" data-anchor-id="two-approaches">Two approaches</h3>
<ul>
<li>First order conditions can be obtained using two approaches
<ul>
<li>Using the Bellman representation
<ul>
<li>derive first order</li>
<li>use enveloppe condition <span class="math display">\[V(s) = \max_{x} ... + \beta \left[ V(s') \right]\]</span></li>
</ul></li>
<li>Using the infinite sum representation
<ul>
<li>using the lagrangian (today: 😋) <span class="math display">\[\max \sum \beta^t U(c_t)\]</span></li>
</ul></li>
</ul></li>
</ul>
<hr>
</section>
<section id="lagrangian" class="level3">
<h3 class="anchored" data-anchor-id="lagrangian">Lagrangian</h3>
<div class="container">
<div class="col">
<p><img src="lagrangian.png" class="img-fluid"></p>
</div>
<div class="col">
<ul>
<li>Baby constrained problem: <span class="math display">\[\max_{x,y} f(x,y)\]</span> <span class="math display">\[g(x,y)-c=0\]</span></li>
<li>Lagrangian approach: <span class="math display">\[\mathcal{L}(x,y) = f(x,y) + \lambda \left(g(x,y) - c \right)\]</span></li>
<li>Optimal solution satisfies: <span class="math display">\[\mathcal{L}^{\prime}_x(x,y)=\mathcal{L}^{\prime}_y(x,y)=0\]</span></li>
<li>Or <span class="math display">\[\begin{bmatrix} f^{\prime}_x\\\\f^{\prime}_y\end{bmatrix} = - \lambda \begin{bmatrix} g^{\prime}_x\\\\g^{\prime}_y\end{bmatrix} \]</span></li>
</ul>
</div>
</div>
<hr>
</section>
<section id="constrained-maximization" class="level3">
<h3 class="anchored" data-anchor-id="constrained-maximization">Constrained maximization</h3>
<ul>
<li>Look at the optimization problem: <span class="math display">\[\max_{c_1, c_2} \log(c_1) + \beta \log(c_2)\]</span> <span class="math display">\[c_1+c_2= C\]</span></li>
<li>Write down the lagrangian: <span class="math display">\[\mathcal{L}(c_1, c_2) =  \log(c_1) + \beta \log(c_2) - \lambda (c_1 + c_2 - C)\]</span></li>
<li>First order conditions: <span class="math display">\[ \frac{1}{c_1} = \beta \frac{1}{c_2} = \lambda\]</span></li>
</ul>
<hr>
</section>
<section id="constrained-maximization-infinite-horizon" class="level3">
<h3 class="anchored" data-anchor-id="constrained-maximization-infinite-horizon">Constrained maximization (infinite horizon)</h3>
<ul>
<li>Look at the infinite horizon optimization problem: <span class="math display">\[\max_{c_0, ,... c_t, ...} \sum_{t=0}^{\infty} \beta^t \log(c_t)\]</span> <span class="math display">\[\sum_{t=0}^{\infty} c_t = C\]</span></li>
<li>This problem is known as a <em>cake-eating</em> problem (usually there is also <span class="math inline">\(c_t\geq0\)</span>)</li>
<li>Write the lagrangian to the infinite (and beyond ??) <span class="math display">\[\mathcal{L}(c_0, c_1, ..., c_t, ...) =  \sum_{t=0}^{\infty} \beta^t \log(c_t) - \lambda \left( \sum_t c_t  - C \right)\]</span></li>
<li>First order conditions: <span class="math display">\[ \beta^t \frac{1}{c_t}  = \lambda\]</span></li>
</ul>
<hr>
</section>
<section id="constrained-maximization-infinite-horizon-1" class="level3">
<h3 class="anchored" data-anchor-id="constrained-maximization-infinite-horizon-1">Constrained maximization (infinite horizon)</h3>
<ul>
<li>The key consists in finding which terms to derive in the sum</li>
<li>Consider the reformulation of the former problem: <span class="math display">\[\max \sum_{t=0}^{\infty} \beta^t \log(c_t)\]</span> <span class="math display">\[\forall t, \\; C_{t+1} = C_t - c_t\]</span></li>
<li>This time the maximum is taken over <span class="math inline">\(c_0, c_1, ...\)</span>, <span class="math inline">\(C_1, C_2, ...\)</span>
<ul>
<li>pay attention to the timing: <span class="math inline">\(C_0\)</span> is <em>predetermined</em></li>
</ul></li>
<li>Set a different lagrange multplier <span class="math inline">\(\lambda_t\)</span> for each date. You should get: <span class="math display">\[\forall t, \\; \beta^t U^{\prime}(c_t) = \lambda_t\]</span> <span class="math display">\[\lambda_t = \lambda_{t+1}\]</span></li>
<li>It can be reformulated as <span class="math inline">\(U^{\prime}(c_t) = \beta U^{\prime}(c_{t+1})\)</span> (Euler equation)</li>
<li>Note that we are missing one condition to close the model (for instance <span class="math inline">\(C_t\geq 0\)</span>)</li>
</ul>
<hr>
</section>
<section id="constrained-maximization-1" class="level3">
<h3 class="anchored" data-anchor-id="constrained-maximization-1">Constrained maximization</h3>
<ul>
<li>The approach outlined, works in the same way when there are several constraints.</li>
<li>Next steps:
<ul>
<li>stochastic problem <span class="math display">\[\max \mathbb{E}  \left[\sum_t\beta^t U(c_t) \right]\]</span></li>
<li>ineqality constraints
<ul>
<li>not very different but multipliers can be 0 (binding) or positive (nonbinding)</li>
<li>theory due to Karush-Kuhn-Tucker rather than Lagrange</li>
</ul></li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="deterministic-neoclassical-growth-model" class="level2">
<h2 class="anchored" data-anchor-id="deterministic-neoclassical-growth-model">Deterministic Neoclassical Growth Model</h2>
<div class="container">

<div class="col">
<ul>
<li><p>Transition Equation <span class="math display">\[\begin{eqnarray}
k_t &amp; = &amp; (1-\delta) k_{t-1} + i_{t-1} \\\\
z_t &amp; = &amp; \rho z_{t-1}
\end{eqnarray}
\]</span></p></li>
<li><p>Budget constraint: <span class="math display">\[c_t = \exp(z_t) k_t^\alpha - i_t\]</span></p></li>
<li><p>Control <span class="math inline">\(c_t \in [0, \exp(z_t) k_t^{\alpha}]\)</span></p></li>
<li><p>Objective (satisfying the constraints) <span class="math display">\[\max_{i_t} \sum_{t\geq0} \beta^t U(c_t)\]</span></p></li>
</ul>
</div>
<div class="col">
<ul>
<li>Calibration:
<ul>
<li><span class="math inline">\(\beta = 0.96\)</span></li>
<li><span class="math inline">\(\delta = 0.1\)</span></li>
<li><span class="math inline">\(\gamma = 4.0\)</span></li>
<li><span class="math inline">\(\alpha = 0.3\)</span></li>
<li><span class="math inline">\(U(x)=\frac{x^{1-\gamma}}{1-\gamma}\)</span></li>
</ul></li>
<li>Remark: optimally agent will never choose <span class="math inline">\(c_t=0\)</span> or <span class="math inline">\(c_t= \exp(z_t) k_t^{\alpha}\)</span>
<ul>
<li>we ignore associated inequality constraints</li>
</ul></li>
</ul>
</div>
<hr>
<section id="lagrangian-1" class="level3">
<h3 class="anchored" data-anchor-id="lagrangian-1">Lagrangian</h3>
<ul>
<li>Initial Conditions (predetermined states): <span class="math inline">\(z_0\)</span>, <span class="math inline">\(k_0\)</span></li>
<li>Problem: <span class="math display">\[V(z_0, k_0) = \max_{\begin{matrix}i_0, i_1, i_2, \cdots \\\\c_0, c_1, c_2 \cdots \\\\ k_1, k_2, \cdots\end{matrix}} \sum_{t \geq 0}\beta^t U(c_t)\]</span> s.t. <span class="math inline">\(\forall t\geq 0\)</span> <span class="math display">\[\begin{eqnarray}
\lambda_t:\quad &amp;  i_t &amp; = &amp; \exp(z_t) k_t^{\alpha} - c_t\\\\
q_t:\quad &amp;  k_{t+1} &amp; = &amp; (1-\delta) k_{t} + i_{t}
\end{eqnarray}\]</span></li>
<li>Lagrangian: <span class="math display">\[\mathcal{L(z_0, k_0)} =   \sum_{t \geq 0} \beta^t\left\\{ U(c_t) +  \lambda_t \left(\exp(z_t) k_t^{\alpha}  - i_t -c_t \right)  + q_t \left( (1-\delta) k_{t} + i_{t} - k_{t+1} \right) \right\\}\]</span></li>
</ul>
<hr>
</section>
<section id="lagrangian-2" class="level3">
<h3 class="anchored" data-anchor-id="lagrangian-2">Lagrangian</h3>
<div class="container">
<div class="col">
<ul>
<li>We maximize the lagrangian to get:</li>
</ul>
<p><span class="math display">\[\begin{eqnarray}
\forall t\geq0 &amp; \frac{\partial \mathcal{L}}{\partial i_t} &amp; = &amp; 0 \\\\
&amp; \frac{\partial \mathcal{L}}{\partial c_t} &amp; = &amp; 0 \\\\
&amp; \frac{\partial \mathcal{L}}{\partial k_{t+1}} &amp; = &amp; 0
\end{eqnarray}\]</span></p>
<ul>
<li>It is important to note that we don’t differentiate with respect to a predetermined state
<ul>
<li>check that you don’t differentiate w.r.t. <span class="math inline">\(k_0\)</span></li>
</ul></li>
<li>It looks like the first order condition added two new variables <span class="math inline">\(\lambda_t\)</span>, <span class="math inline">\(q_t\)</span></li>
</ul>
</div>
<div class="col">
<ul>
<li>Luckily these variables are associated to constraints. | | | —————————————- | | <span class="math inline">\((1-\delta) k_{t} + i_{t} - k_{t+1} = 0\)</span> | | <span class="math inline">\(\exp(z_t) k_t^{\alpha} - i_t -c_t = 0\)</span> |
<ul>
<li>which make the problem square again</li>
</ul></li>
</ul>
</div>
</div>
<hr>
</section>
<section id="first-order-model" class="level3">
<h3 class="anchored" data-anchor-id="first-order-model">First order model</h3>
<ul>
<li>Optimality Condition: <span class="math display">\[\beta  \left[ \frac{\left(c_{t+1}\right)^{-\gamma}}{\left(c_t\right)^{-\gamma}} \left( (1-\delta + \alpha \exp(z_{t+1}) k_{t+1}^{\alpha -1}) \right)\right] = 1\]</span>
<ul>
<li>Takes into account the fact that optimally <span class="math inline">\(c_t&gt;0\)</span> and <span class="math inline">\(i_t&gt;0\)</span>.</li>
</ul></li>
<li>Budget Constraint: <span class="math display">\[c_t = exp(z_t) k_t^\alpha - i_t\]</span></li>
<li>Transition: <span class="math display">\[k_t = (1-\delta) k_{t-1} + i_{t-1}\]</span> <span class="math display">\[z_t = \rho z_{t-1}\]</span></li>
</ul>
<hr>
</section>
<section id="steady-state" class="level3">
<h3 class="anchored" data-anchor-id="steady-state">Steady-State</h3>
<div class="container">
<div class="col">
<ul>
<li>Steady-State: <span class="math inline">\(\overline{i}, \overline{k}, \overline{z}\)</span> such that:
<ul>
<li><span class="math inline">\(z_{t+1}=k_t=\overline{z}\)</span></li>
<li><span class="math inline">\(k_{t+1}=k_t=\overline{k}\)</span></li>
<li><span class="math inline">\(i_{t+1}=i_t=\overline{i}\)</span></li>
</ul></li>
<li>…satisfy the first order conditions</li>
<li>…i.e. <span class="math display">\[\beta   \left( (1-\delta + \alpha {\overline{k}}^{\alpha -1}) \right) = 1\]</span> <span class="math display">\[\overline{k}=  (1-\delta) \overline{k} + \overline{i}\]</span> <span class="math display">\[\overline{z} = \rho \overline{z}\]</span></li>
</ul>
</div>
<div class="col">
<ul>
<li>Solution?
<ul>
<li>closed-form</li>
<li>numerical</li>
</ul></li>
<li>Here we can get a closed form:</li>
</ul>
<p><span class="math display">\[\begin{eqnarray}
\overline{k} &amp; = &amp; \left( \frac{\frac{1}{\beta}-(1-\delta)}{\alpha} \right)^{\frac{1}{\alpha - 1}} \\\\
\overline{i} &amp; = &amp; \delta \overline{k} \\\\\
\overline{z} &amp; = &amp; 0
\end{eqnarray}\]</span></p>
</div>
</div>
<hr>
</section>
</div></section>
<section id="perturbation-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="perturbation-analysis-1">Perturbation Analysis</h2>
<hr>
<section id="general-idea" class="level3">
<h3 class="anchored" data-anchor-id="general-idea">General idea</h3>
<ul>
<li>We know the model at the steady-state</li>
<li>Linearize it around the steady-state</li>
<li>Characterize its dynamics for small deviations around the steady-state</li>
</ul>
<hr>
</section>
<section id="d-example-1" class="level3">
<h3 class="anchored" data-anchor-id="d-example-1">1d Example 1</h3>
<ul>
<li>Take function <span class="math inline">\(f: \\; \mathbb{R}\rightarrow \mathbb{R}\)</span>
<ul>
<li>define model $ t \; x_t = f(x_{t-1})$</li>
</ul></li>
<li><!-- .element: class="fragment" -->
Find steady-state <span class="math inline">\(\overline{x}\)</span> s.t. <span class="math inline">\(f(\overline{x})=\overline{x}\)</span></li>
<li><!-- .element: class="fragment" -->
Taylor expansion: <span class="math display">\[ \overline{x} + (x_{t} - \overline{x}) \approx f(\overline{x}) + f^{\prime}(\overline{x})(x_{t-1}-\overline{x})\]</span></li>
<li><!-- .element: class="fragment" -->
First order model: <span class="math display">\[ \lambda (x_{t-1} - \overline{x}) = (x_{t}-\overline{x}) \]</span></li>
<li><!-- .element: class="fragment" -->
Easy to solve: <span class="math display">\[x_t-\overline{x} = \lambda^t (x_0 - \overline{x})\]</span></li>
</ul>
<hr>
</section>
<section id="d-example-2" class="level3">
<h3 class="anchored" data-anchor-id="d-example-2">1d Example 2</h3>
<ul>
<li>Take function <span class="math inline">\(f: \\; \mathbb{R}\rightarrow \mathbb{R}\)</span>
<ul>
<li>define model <em>implicitly</em> by <span class="math display">\[\forall t \\; f(x_{t-1}, x_{t})=0\]</span></li>
</ul></li>
<li>Find steady-state <span class="math inline">\(\overline{x}\)</span> such that: <span class="math display">\[f(\overline{x}, \overline{x})=0\]</span></li>
</ul>
<div class="r-stack">
<div class="fragment current-visible">
<ul>
<li><strong>Implicit Function Theorem</strong>: there is a unique <span class="math inline">\(\varphi\)</span> such that <span class="math display">\[\forall x_t \\; f(x_t, \varphi(x_{t})) = 0\]</span></li>
<li>It satisfies <span class="math inline">\(\varphi(\overline{x})=\overline{x}\)</span> and <span class="math inline">\(\varphi^{\prime}(\overline{x}) = - \frac{f^{\prime}\_{x_t}(\overline{x}, \overline{x})}{f^{\prime}\_{x_{t-1}}(\overline{x}, \overline{x})}\)</span></li>
</ul>
</div>
<div class="fragment current-visible">
<ul>
<li>In practice, we use the undetermined coefficient method</li>
<li>Approximate model close to <span class="math inline">\(\overline{x}\)</span> by: <span class="math display">\[\underbrace{f^{\prime}\_{x\_{t-1}}}\_{A} (x\_{t-1}-\overline{x}) + \underbrace{f^{\prime}\_{x\_t}}\_{B} (x_{t}-\overline{x}) = 0\]</span></li>
<li>Look for <span class="math inline">\((x_t-\overline{x})=\lambda (x_{t-1}-\overline{x})\)</span> with unknown <span class="math inline">\(\lambda\)</span>.</li>
<li><span class="math inline">\(\lambda\)</span> satisfies <span class="math inline">\(\lambda = -\frac{A}{B}\)</span></li>
</ul>
</div>
</div>
<hr>
</section>
<section id="d-example-3" class="level3">
<h3 class="anchored" data-anchor-id="d-example-3">1d example 3</h3>
<ul>
<li><p>In general economic models link future and past: <span class="math display">\[\forall t \\; f(x_{t-1}, x_t, x_{t+1}) = 0\]</span></p></li>
<li><p>Linearize model: <span class="math display">\[A \Delta x_{t-1} + B \Delta x_t + C x_{t+1} \\equiv 0\]</span></p></li>
<li><p>Look for a recursive solution as: <span class="math display">\[x_t = \lambda x_{t-1}\]</span></p></li>
<li><p><span class="math inline">\(\lambda\)</span> is one of two roots <span class="math inline">\(\lambda_1, \lambda_2\)</span> of <span class="math inline">\(A + B X + C X^2\)</span></p></li>
<li><p>There is a <strong>unique</strong>, <strong>stable</strong> solution iff <span class="math inline">\(\lambda_1 \leq 1 &lt; \lambda_2\)</span></p></li>
</ul>
<hr>
</section>
<section id="perturb-the-neoclassical-model" class="level3">
<h3 class="anchored" data-anchor-id="perturb-the-neoclassical-model">Perturb the neoclassical model</h3>
<div class="container">

<div class="col">
<ul>
<li>Write all variables in deviation to the steady-state: <span class="math display">\[z_{t}=\overline{z} + \Delta z_t\]</span> <span class="math display">\[k_{t}=\overline{k} + \Delta k_t\]</span> <span class="math display">\[i_{t}=\overline{i} + \Delta i_t\]</span> <span class="math display">\[c_{t}=\overline{c} + \Delta c_t\]</span>
<ul>
<li>Remark: some smart economists use log-deviations (i.e.&nbsp;<span class="math inline">\(x_t = \overline{x} \hat{x}_t\)</span> to make computations easier)</li>
</ul></li>
</ul>
</div>
<div class="col">
<ul>
<li>Replace in the system <span class="math display">\[\beta  \left[ \frac{\left(\overline{c}+ \Delta c_{t+1}\right)^{-\gamma}}{\left(\overline{c} + \Delta c_t\right)^{-\gamma}} \left( (1-\delta + \alpha (\overline{k} + \Delta k_{t+1})^{\alpha -1}) \right)\right] = 1\]</span> <span class="math display">\[\overline{c} + \Delta c_t = (\overline{k}+ \Delta k_t)^\alpha - \overline{i} - \Delta i_t\]</span> <span class="math display">\[\overline{k} + \Delta k_t = (1-\delta) (\overline{k}+ \Delta k_{t-1}) + \overline{i }+ \Delta i_{t-1}\]</span> <span class="math display">\[\overline{z }+ \Delta z_t = \overline{z}+ \Delta \rho z_{t-1}\]</span></li>
<li>Differentiate…</li>
<li>(if we want to limit the number of equations, we can replace <span class="math inline">\(c_t\)</span> by its value)</li>
</ul>
</div>
<hr>
</div></section>
<section id="result" class="level3">
<h3 class="anchored" data-anchor-id="result">Result:</h3>
<ul>
<li><p>Optimality Condition <span class="math display">\[\begin{bmatrix} . &amp; . &amp; . \\ \end{bmatrix} \begin{bmatrix} \Delta c_t \\\\  \Delta i_t \\\\ \Delta k_t \\\\ \Delta z_t \end{bmatrix} = \begin{bmatrix} . &amp; . &amp; . \\ \end{bmatrix} \begin{bmatrix} \Delta c_{t+t} \\\\ \Delta i_{t+1} \\\\ \Delta k_{t+1} \\\\ \Delta z_{t+1} \end{bmatrix} \]</span></p></li>
<li><p>Transition <span class="math display">\[ \begin{bmatrix} \Delta k_t \\\\ \Delta z_t \end{bmatrix} = \begin{bmatrix} . &amp; .  \\\\ . &amp; . \end{bmatrix} \begin{bmatrix} \Delta k_{t-1} \\\\ \Delta z_{t-1} \end{bmatrix}  + \begin{bmatrix} . \end{bmatrix} \begin{bmatrix}\Delta  c_{t-1}\\\\ \Delta i_{t-1}\end{bmatrix}\]</span></p></li>
</ul>
<hr>
</section>
</section>
<section id="solution-using-linear-time-iteration" class="level2">
<h2 class="anchored" data-anchor-id="solution-using-linear-time-iteration">Solution using Linear Time iteration</h2>
<hr>
<section id="our-problem" class="level3">
<h3 class="anchored" data-anchor-id="our-problem">Our problem</h3>
<div class="container">

<div class="col">
<ul>
<li>General formulation of a <em>linearized</em> model: <span class="math display">\[ \begin{eqnarray} A s_t + B x_t + C s_{t+1} + D x_{t+1} &amp; = &amp; 0_{n_x} \\\\
s_{t+1} &amp; = &amp; E s_t + F x_t \end{eqnarray}\]</span> where:
<ul>
<li><span class="math inline">\(s_t \in \mathbb{R}^{n_s}\)</span> is a vector of <em>states</em></li>
<li><span class="math inline">\(x_t \in \mathbb{R}^{n_x}\)</span> is a vector of <em>controls</em></li>
</ul></li>
<li>Remark:
<ul>
<li>first equation is <em>forward</em> looking</li>
<li>second equation is <em>backward</em> looking</li>
</ul></li>
</ul>
</div>
<div class="col">
<div>
<ul>
<li><p>In the neoclassical model: <span class="math display">\[\begin{eqnarray}
s_t &amp; = &amp; (\Delta z_t, \Delta k_t) \\\\
x_t &amp; = &amp; (\Delta c_t, \Delta i_t)
\end{eqnarray}\]</span></p></li>
<li><p>The linearized system is: <span class="math display">\[\begin{eqnarray}
A &amp; = &amp; ...\\\\
B &amp; = &amp; ...\\\\
C &amp; = &amp; ...\\\\
D &amp; = &amp; ...\\\\
E &amp; = &amp; ...\\\\
F &amp; = &amp;
\end{eqnarray}\]</span></p></li>
</ul>
</div>
</div>
<hr>
</div></section>
<section id="solution" class="level3">
<h3 class="anchored" data-anchor-id="solution">Solution</h3>
<div class="container">
<div class="col">
<ul>
<li><p>What is the solution of our problem?</p></li>
<li><p>At date <span class="math inline">\(t\)</span> <em>controls</em> must be chosen as a function of (predetermined) <em>states</em></p></li>
<li><p>Mathematically speaking, the solution is a function <span class="math inline">\(\varphi\)</span> such that: <span class="math display">\[\forall t, x_t = \varphi(s_t)\]</span></p></li>
<li><p>Since the model is linear we look for un unknown matrix <span class="math inline">\(X \in \mathbb{R}^{n_x} \times \mathbb{R}^{n_s}\)</span> such that:</p></li>
</ul>
<p><span class="math display">\[\Delta x_t = X \Delta s_t\]</span></p>
</div>
<div class="col">
<div>
<p>In the neoclassical model - The controls <span class="math inline">\(c_t, i_t\)</span> must be a function of the states - there is a decision rule <span class="math inline">\(c(), i()\)</span> such that <span class="math display">\[c_t=c(z_t, k_t) \\; i_t = i(z_t, k_t)\]</span> - In the linearized model: <span class="math display">\[\Delta c_t =c_z \Delta c_t + c_k \Delta k_t\]</span> <span class="math display">\[\Delta i_t =i_z \Delta z_t + i_k \Delta k_t\]</span></p>
<ul>
<li><span class="math inline">\(k_t\)</span> and <span class="math inline">\(z_t\)</span>: the states</li>
</ul>
</div>
</div>
<hr>
</div></section>
<section id="optimality-condition" class="level3">
<h3 class="anchored" data-anchor-id="optimality-condition">Optimality condition:</h3>
<div class="container">
<div class="col">
<ul>
<li><p>Replacing in the system: <span class="math display">\[ \begin{eqnarray}
\Delta x_t &amp; = &amp; X \Delta s_t \\\\
\Delta s_{t+1} &amp; = &amp; E \Delta s_t + F X \Delta s_t \\\\
\Delta x_{t+1} &amp; = &amp; X \Delta s_{t+1} \\\\
A \Delta s_t + B \Delta x_t + C \Delta s_{t+1} + D \Delta x_{t+1} &amp; = &amp; 0
\end{eqnarray}
\]</span></p></li>
<li><p>If we make the full substitution:</p></li>
</ul>
<p><span class="math display">\[( (A + B X) + ( D X + C) ( E  + F X ) ) s_t = 0\]</span></p>
</div>
<div class="col">
<ul>
<li>This must be true for all <span class="math inline">\(s_t\)</span>. We get the special Ricatti equation:</li>
</ul>
<p><span class="math display">\[(A + B \color{red}{X}) + ( D \color{red}{X} + C) ( E  + F \color{red}{X} ) = 0 \]</span></p>
<ul>
<li>this is a <strong>quadratic</strong>, <strong>matrix</strong> ( <span class="math inline">\(X\)</span> is 1 by 2 ) equation:
<ul>
<li>requires special solution method</li>
<li>there are multiple solutions: which should we choose?
<ul>
<li>today: linear time iteration selects only one solution</li>
<li>next time: eigenvalues analysis</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<hr>
</section>
<section id="linear-time-iteration" class="level3">
<h3 class="anchored" data-anchor-id="linear-time-iteration">Linear Time Iteration</h3>
<ul>
<li>Let’s be more subtle: define
<ul>
<li><span class="math inline">\(X\)</span>: decision rule today and</li>
<li><span class="math inline">\(\tilde{X}\)</span> is decision rule tomorrow. <span class="math display">\[\begin{eqnarray}
\Delta x_t &amp; =&amp;  X \Delta s_t \\\\
\Delta s_{t+1} &amp; = &amp; E \Delta  s_t + F X \Delta s_t \\\\
\Delta x_{t+1} &amp; = &amp; \tilde{X} \Delta s_{t+1} \\\\
A \Delta s_t + B \Delta x_t + C \Delta s_{t+1} + D \Delta x_{t+1} &amp; = &amp; 0
\end{eqnarray}\]</span></li>
</ul></li>
<li>We get, <span class="math inline">\(\forall s_t\)</span>: <span class="math display">\[(A + B X) + (C + D \tilde{X}) ( E  + F X ) ) \Delta s_t = 0 \]</span></li>
<li>Again, this must be zero in all states <span class="math inline">\(\Delta s_t\)</span>.</li>
</ul>
<hr>
</section>
<section id="linear-time-iteration-2" class="level3">
<h3 class="anchored" data-anchor-id="linear-time-iteration-2">Linear Time Iteration (2)</h3>
<div class="container">
<div class="col">
<ul>
<li>We get the equation: <span class="math display">\[F(X, \tilde{X}) = (A + B X) + ( C+ D \tilde{X}) ( E  + F X ) = 0 \]</span></li>
<li>Consider the <em>linear time iteration</em> algorithm</li>
<li>When the model is well-specified it is guaranteed to converge to the right solution.
<ul>
<li>cf <em>linear time iteration</em> by Pontus Rendahl (<a href="https://irihs.ihs.ac.at/id/eprint/4351/1/es-330.pdf">link</a>)</li>
</ul></li>
<li>There are simple criteria to check that the solution is right, and that the model is well specified</li>
<li><span class="math inline">\(T\)</span> is the time iteration operator… for linear models
<ul>
<li>it does <em>forward iteration</em> (<span class="math inline">\(X_t\)</span> as a function of <span class="math inline">\(X_{t+1}\)</span>)</li>
</ul></li>
</ul>
</div>
<div class="col">
<ul>
<li>algorithm:
<ul>
<li>choose stopping criteria: <span class="math inline">\(\epsilon_0\)</span> and <span class="math inline">\(\eta_0\)</span></li>
<li>choose random <span class="math inline">\(X_0\)</span></li>
<li>given <span class="math inline">\(X_n\)</span>:
<ul>
<li>compute <span class="math inline">\(X_{n+1}\)</span> such that <span class="math inline">\(F(X_{n+1}, X_{n}) = 0\)</span> <span class="r-stack"><span class="fragment current-visible"><span class="math display">\[(B + (C+D X_{n})F)X_{n+1} + A  + (C+D X_n )E=0\]</span></span><span class="fragment current-visible"><span class="math display">\[X_{n+1} = (B + (C + D X_n) F)^{-1} (A + (C+DX_n)E)\]</span></span><span class="fragment"><span class="math display">\[X_{n+1} = T(X_n)\]</span></span></span></li>
<li>compute:
<ul>
<li><span class="math inline">\(\eta_n = |X_{n+1} - X_n|\)</span></li>
<li><span class="math inline">\(\epsilon_n = F(X_{n+1}, X_{n+1})\)</span></li>
</ul></li>
<li>if <span class="math inline">\(\eta_n&lt;\eta_0\)</span> and <span class="math inline">\(\epsilon_n&lt;\epsilon_0\)</span>
<ul>
<li>stop and return <span class="math inline">\(X_{n+1}\)</span></li>
<li>otherwise iterate with <span class="math inline">\(X_{n+1}\)</span></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<hr>
</section>
<section id="simulating-the-model" class="level3">
<h3 class="anchored" data-anchor-id="simulating-the-model">Simulating the model</h3>
<ul>
<li>Suppose we have found the solution <span class="math inline">\(\Delta x_t = X \Delta s_t\)</span></li>
<li>Recall the transition equation: <span class="math inline">\(\Delta s_{t+1} = F \Delta s_t + G \Delta x_t\)</span></li>
<li>We can now compute the model evolution following initial deviation in the state: <span class="math display">\[\Delta s_t = \underbrace{(F + G X)}\_{P} \Delta s\_{t-1}\]</span>
<ul>
<li><span class="math inline">\(P\)</span> is the simulation operator</li>
<li>it does <em>backward</em> iteration (TODO: example of a reaction to a shock)</li>
</ul></li>
<li>The system is stable if the biggest eigenvalue of <span class="math inline">\(P\)</span> is smaller than one…</li>
<li>… or if its spectral radius is smaller than 1: <span class="math display">\[\rho(P)&lt;1\]</span></li>
<li>This condition is called <em>backward</em> stability
<ul>
<li>it rules out <em>explosive solutions</em></li>
<li>if <span class="math inline">\(\rho(P)&gt;1\)</span> one can always find <span class="math inline">\(s_0\)</span> such that the model simulation diverges</li>
</ul></li>
</ul>
<hr>
</section>
<section id="spectral-radius" class="level3">
<h3 class="anchored" data-anchor-id="spectral-radius">Spectral radius</h3>
<div class="container">
<div class="col">
<ul>
<li>How do you compute the spectral radius of matrix P?
<ul>
<li>naive approach: compute all eigenvalues, check the value of the biggest one…</li>
<li>better approach: power iteration method</li>
</ul></li>
<li>Power iteration method:
<ul>
<li>take a linear operator <span class="math inline">\(L\)</span> over a Banach Space <span class="math inline">\(\mathcal{B}\)</span> (vector space with a norm)</li>
<li>use the fact that <em>for most</em> <span class="math inline">\(u_0\in \mathcal{B}\)</span>, <span class="math inline">\(\frac{|L^{n+1} u_0|}{|L^n u_0|}\rightarrow \rho(L)\)</span></li>
</ul></li>
</ul>
</div>
<div class="col">
<ul>
<li>Algorithm:
<ul>
<li>choose tolerance criterium: <span class="math inline">\(\eta&gt;0\)</span></li>
<li>choose random initial <span class="math inline">\(x_0\)</span> and define <span class="math inline">\(u_0 = \frac{x_0}{|x_0|}\)</span>
<ul>
<li>by construction: <span class="math inline">\(|u_0|=1\)</span></li>
</ul></li>
<li>given <span class="math inline">\(u_n\)</span>, compute
<ul>
<li><span class="math inline">\(x_{n+1} = L.u_n\)</span></li>
<li><span class="math inline">\(u_{n+1} = \frac{x_{n+1}}{|x_{n+1}|}\)</span></li>
<li>compute <span class="math inline">\(\eta_{n+1} = |u_{n+1} - u_n|\)</span></li>
<li>if <span class="math inline">\(\eta_{n+1}&lt;\eta\)</span>:
<ul>
<li>stop and return <span class="math inline">\(|x_{n+1}|\)</span></li>
<li>else iterate with <span class="math inline">\(u_{n+1}\)</span></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<hr>
</section>
<section id="stability-of-the-backward-operator" class="level3">
<h3 class="anchored" data-anchor-id="stability-of-the-backward-operator">Stability of the backward operator</h3>
<ul>
<li>To solve the model we use the backard operator: <span class="math display">\[T: \begin{eqnarray} \mathbb{R}^{n_x} \times \mathbb{R}^{n_s}  &amp; \rightarrow &amp;  \mathbb{R}^{n_x} \times \mathbb{R}^{n_s}  \\\\X_{t+1} &amp; \mapsto &amp; X_t \text{s.t.} F(X_t,X_{t+1})=0\end{eqnarray}\]</span></li>
<li>What about its stability?
<ul>
<li>TODO: interpretation</li>
</ul></li>
<li>Recall: fixed point <span class="math inline">\(\overline{z}\)</span> of recursive sequence <span class="math inline">\(z_n=f(z_{n_1})\)</span> is stable if <span class="math inline">\(|f^{\prime}(\overline{z})|&lt;1\)</span></li>
<li>We need to study <span class="math inline">\(T^{\prime}\)</span> of (<span class="math inline">\(X\)</span>).
<ul>
<li>but <span class="math inline">\(T\)</span> maps a matrix to another matrix 🐉😓</li>
<li>how do we differentiate it?</li>
</ul></li>
</ul>
<p><img class="fragment" src="adele_bs.jpg"></p>
<hr>
</section>
<section id="differentials" class="level3">
<h3 class="anchored" data-anchor-id="differentials">Differentials</h3>
<ul>
<li>Consider a Banach Space <span class="math inline">\(\mathcal{B}\)</span>.</li>
<li>Consider an operator (i.e.&nbsp;a function): <span class="math inline">\(\mathcal{T}: \mathcal{B} \rightarrow \mathcal{B}\)</span>.</li>
<li>Consider <span class="math inline">\(\overline{x} \in \mathcal{B}\)</span>.</li>
<li><span class="math inline">\(\mathcal{T}\)</span> is differentiable at <span class="math inline">\(\overline{x}\)</span> if there exists a bounded linear operator <span class="math inline">\(L \in \mathcal{L}(\mathcal{B})\)</span> such that: <span class="math display">\[\mathcal{T}(x) = \overline{x} + L.(x-\overline{x}) + o(|x-\overline{x}|)\]</span></li>
<li>when it exists we denote this operator by <span class="math inline">\(\mathcal{T}^{\prime}(\overline{x})\)</span></li>
<li>Remarks:
<ul>
<li>Bounded operator means: <span class="math inline">\(\sup_{|x|=1} |L.x|&lt;+\infty\)</span></li>
<li>This definition of a derivative is usually referred to as Fréchet-derivative</li>
</ul></li>
</ul>
<hr>
</section>
<section id="examples-of-linear-operators" class="level3">
<h3 class="anchored" data-anchor-id="examples-of-linear-operators">Examples of linear operators</h3>
<ul>
<li><span class="math inline">\(x\)</span> vector, A a matrix, <span class="math inline">\(T(x) = Ax\)</span>
<ul>
<li>then <span class="math inline">\(T(x+u) = Ax + A.u + 0\)</span></li>
<li><span class="math inline">\(T^{\prime}(x) = A\)</span> for all x</li>
</ul></li>
<li><span class="math inline">\(A\)</span> a matrix, B a matrix, X a matrix: <span class="math inline">\(T(X) = A X B\)</span>
<ul>
<li>then <span class="math inline">\(T(X+u) = A X B + A u B + 0\)</span></li>
<li><span class="math inline">\(T^{\prime}(X).u = A u B\)</span></li>
</ul></li>
<li><span class="math inline">\(A\)</span> a matrix, X a matrix: <span class="math inline">\(T(X) = A X B\)</span>
<ul>
<li>then <span class="math inline">\(T(X+u) = A X B + A u B\)</span></li>
<li><span class="math inline">\(T^{\prime}(X).u = A u B\)</span></li>
</ul></li>
</ul>
<hr>
</section>
<section id="back-to-the-time-iteration-operator" class="level3">
<h3 class="anchored" data-anchor-id="back-to-the-time-iteration-operator">Back to the time iteration operator</h3>
<ul>
<li><span class="math inline">\(T(X)\)</span> is implicitly defined by <span class="math inline">\(F(T(X), X)=0\)</span></li>
<li><span class="math inline">\(F(X,Y) = (A + B X) + ( C+ D Y) ( E + F X )\)</span>
<ul>
<li>it is linear in <span class="math inline">\(X\)</span> and in <span class="math inline">\(Y\)</span></li>
</ul></li>
<li><span class="math inline">\(F^{\prime}_X (X, Y).u = (B + (C+DY)F) u\)</span>
<ul>
<li>a regular matrix multiplication</li>
<li>its inverse is: <span class="math inline">\(F^{\prime}_X (X, Y)^{-1} = (B + (C+DY)F)^{-1}\)</span></li>
</ul></li>
<li><span class="math inline">\(F^{\prime}_Y (X, Y).u = D u (E+FX)\)</span>
<ul>
<li>a linear operation on matrices</li>
</ul></li>
</ul>
<hr>
</section>
<section id="the-derivative-of-the-time-iteration-operator" class="level3">
<h3 class="anchored" data-anchor-id="the-derivative-of-the-time-iteration-operator">The derivative of the time-iteration operator</h3>
<ul>
<li>Implicit relation can be differentiated: <span class="math display">\[F^{\prime}_X (T(X), X) T^{\prime} (X) + F_Y^{\prime}(T(X),X) = 0\]</span></li>
<li><span class="math inline">\(F^{\prime}_X (T(X), X)\)</span> being a regular matrix, it is (conceptually) easy to invert: <span class="math display">\[T^{\prime}(X) = -(F^{\prime}_X (T(X), X))^{-1}F_Y^{\prime}(T(X),X)\]</span></li>
<li>Finally, we get the explicit formula for the linear operator <span class="math inline">\(T^{\prime}\)</span> computed at the steady state: <span class="math display">\[T^{\prime}(\overline{X}).u = ((B + (C+D \overline{X})F)^{-1})D u (E+F \overline{X})\]</span></li>
<li>We can compute the spectral radius of <span class="math inline">\(T^{\prime}(\overline{X})\)</span> using the power iteration method</li>
</ul>
<hr>
</section>
<section id="recap" class="level3">
<h3 class="anchored" data-anchor-id="recap">Recap</h3>
<ol type="1">
<li>We compute the derivatives of the model</li>
<li>Time iteration algorithm, starting from an initial guess <span class="math inline">\(X_0\)</span> and we repeat until convergence: <span class="math display">\[X_{n+1} = (B + (C + D X_n) F)^{-1} (A + (C+DX_n)E)\]</span></li>
<li>We compute the spectral radius of two operators to ensure the model is well defined and that the solution is the right one.</li>
<li>backward stability: derivative of simulation operator <span class="math display">\[\rho(E + F \overline{X} )&lt;1\]</span></li>
<li>forward stability: derivative of time iteration operator <span class="math display">\[\rho \left( u\mapsto ((B + (C+D \overline{X})F)^{-1})D u (E+F \overline{X}) \right) &lt;1\]</span></li>
</ol>
<p>This is equivalent to the so-called <strong>Blanchard-Kahn conditions</strong>.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>